angular.module("d3app",["ngRoute","d3"]),angular.module("d3",[]).factory("d3Service",["$document","$q","$rootScope",function(a,b,c){function d(){c.$apply(function(){e.resolve(window.d3)})}var e=q.defer(),f=a[0].createElement("script");f.type="text/javascript",f.async=!0,f.src="public/vendors/d3/build/d3.min.js",f.onreadystatechange=function(){"complete"==this.readyState&&d()},f.onload=d;var g=a[0].getElementsByTagName("body")[0];return g.appendChild(f),{d3:function(){return e.promise}}}]),angular.module("d3app").config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"/views/firstgraph.html",controller:"FirstGraphController",controllerAs:"one"}),b.html5Mode(!0)}]),angular.module("d3app").directive("heatmap",function(){return{restrict:"EA",scope:{checkins:"="},link:function(a,b,c){var d=a,e={top:50,right:0,bottom:100,left:30},f=960-e.left-e.right,g=430-e.top-e.bottom,h=Math.floor(f/24),i=2*h,j=10,k=["rgba(25, 29, 72, .1)","rgba(25, 29, 72, .2)","rgba(25, 29, 72, .3)","rgba(25, 29, 72, .4)","rgba(25, 29, 72, .5)","rgba(25, 29, 72, .6)","rgba(25, 29, 72, .7)","rgba(25, 29, 72, .8)","rgba(25, 29, 72, .9)"],l=["Mo","Tu","We","Th","Fr","Sa","Su"],m=["1a","2a","3a","4a","5a","6a","7a","8a","9a","10a","11a","12a","1p","2p","3p","4p","5p","6p","7p","8p","9p","10p","11p","12p"];datasets=[d.tsv];var n=d3.select("#chart").append("svg").attr("width",f+e.left+e.right).attr("height",g+e.top+e.bottom).append("g").attr("transform","translate("+e.left+","+e.top+")"),o=(n.selectAll(".dayLabel").data(l).enter().append("text").text(function(a){return a}).attr("x",0).attr("y",function(a,b){return b*h}).style("text-anchor","end").attr("transform","translate(-6,"+h/1.5+")").attr("class",function(a,b){return b>=0&&b<=4?"dayLabel mono axis axis-workweek":"dayLabel mono axis"}),n.selectAll(".timeLabel").data(m).enter().append("text").text(function(a){return a}).attr("x",function(a,b){return b*h}).attr("y",0).style("text-anchor","middle").attr("transform","translate("+h/2+", -6)").attr("class",function(a,b){return b>=7&&b<=16?"timeLabel mono axis axis-worktime":"timeLabel mono axis"}),function(a){d3.tsv(a,function(a){return{day:+a.day,hour:+a.hour,value:+a.value}},function(a,b){var c=d3.scaleQuantile().domain([0,j-1,9]).range(k),d=n.selectAll(".hour").data(week,function(a){return a.day+":"+a.hour});d.append("title"),d.enter().append("rect").attr("x",function(a){return(a.hour-1)*h}).attr("y",function(a){return(a.day-1)*h}).attr("rx",4).attr("ry",4).attr("class","hour bordered").attr("width",h).attr("height",h).style("fill",k[0]),d.transition().duration(1e3).style("fill",function(a){return c(a.value)}),d.select("title").text(function(a){return a.value}),d.exit().remove();var e=n.selectAll(".legend").data([0].concat(c.quantiles()),function(a){return a});e.enter().append("g").attr("class","legend"),e.append("rect").attr("x",function(a,b){return i*b}).attr("y",g).attr("width",i).attr("height",h/2).style("fill",function(a,b){return k[b]}),e.append("text").attr("class","mono").text(function(a){return"â‰¥ "+Math.round(a)}).attr("x",function(a,b){return i*b}).attr("y",g+h),e.exit().remove()})});o(datasets[0]);var p=d3.select("#dataset-picker").selectAll(".dataset-button").data(datasets);p.enter().append("input").attr("value",function(a){return"Wellness Scores"}).attr("type","button").attr("class","dataset-button").on("click",function(a){o(a)})}}}),angular.module("d3app").controller("FirstGraphController",["$scope","$http","$location",function(a,b,c){a.greeting="Resize the page to see the re-rendering",a.data=[{name:"Greg",score:98},{name:"Ari",score:96},{name:"Q",score:75},{name:"Loser",score:48}]}]);